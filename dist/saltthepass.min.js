/*! saltthepass v0.3.0 */

!function(a,b){"use strict";"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.SaltThePassUtils=b()}(this,function(){"use strict";var a={};return a.standardizeDomain=function(a){if("undefined"==typeof a)return"";var b=a.toLowerCase();return"http://"===b.substring(0,"http://".length)&&(b=b.substring("http://".length)),"https://"===b.substring(0,"https://".length)&&(b=b.substring("https://".length)),b.indexOf("/")!==-1&&(b=b.substring(0,b.indexOf("/"))),b},a}),function(a,b){"use strict";"function"==typeof define&&define.amd?define(["./utils"],b):"object"==typeof exports?module.exports=b(require("./utils")):a.DomainNameRule=b(a.SaltThePassUtils)}(this,function(a){"use strict";function b(a){"undefined"!=typeof a&&(this.domain=a.domain,a.aliases instanceof Array?this.aliases=a.aliases.slice():this.aliases=[],this.description=a.description,this.min="undefined"!=typeof a.min?parseInt(a.min,10)||0:0,this.max="undefined"!=typeof a.max?parseInt(a.max,10)||Number.MAX_VALUE:Number.MAX_VALUE,this.invalid="undefined"!=typeof a.invalid?a.invalid:"",this.required="undefined"!=typeof a.required?a.required:"",this.regex=a.regex,this.validregex=a.validregex)}return b.prototype.hasMin=function(){return 0!==this.min},b.prototype.hasMax=function(){return this.max!==Number.MAX_VALUE},b.prototype.hasRequired=function(){return 0!==this.required.length},b.prototype.hasInvalid=function(){return 0!==this.invalid.length},b.prototype.hasRegex=function(){return"undefined"!=typeof this.regex},b.prototype.hasValidRegex=function(){return"undefined"!=typeof this.validregex},b.prototype.matches=function(b){var c=a.standardizeDomain(b);if(c===this.domain)return!0;for(var d=0;d<this.aliases.length;d++){var e=this.aliases[d];if(e===c)return!0}return!1},b.prototype.isValid=function(a){return!!this.isValidMin(a)&&(!!this.isValidMax(a)&&(!!this.isValidRequired(a)&&(!!this.isValidInvalid(a)&&(!!this.isValidRegex(a)&&!!this.isValidValidRegex(a)))))},b.prototype.isValidMin=function(a){return a.length>=this.min},b.prototype.isValidMax=function(a){return a.length<=this.max},b.prototype.isValidRequired=function(a){if(0===this.required.length)return!0;for(var b=!1,c=0;c<this.required.length;c++)if(a.indexOf(this.required[c])!==-1){b=!0;break}return!(this.required.length>0&&!b)},b.prototype.isValidInvalid=function(a){if(0===this.invalid.length)return!0;for(var b=0;b<this.invalid.length;b++)if(a.indexOf(this.invalid[b])!==-1)return!1;return!0},b.prototype.isValidRegex=function(a){if(this.regex){var b=this.getRegEx();if(!b.test(a))return!1}return!0},b.prototype.isValidValidRegex=function(a){if(this.validregex){var b=this.getValidRegEx();if(!b.test(a))return!1}return!0},b.prototype.getRegEx=function(){if(this.regex)return new RegExp(this.regex)},b.prototype.getValidRegEx=function(a){if(this.validregex)return a?new RegExp("[^"+this.validregex+"]","g"):new RegExp("^["+this.validregex+"]+$")},b.prototype.rewrite=function(a){if(this.isValid(a))return a;for(var b=a,c=0;c<this.invalid.length;c++)for(var d=-1,e=this.invalid[c];(d=b.indexOf(e))!==-1;)b=b.substr(0,d)+b.substr(d+1);if(this.validregex){var f=this.getValidRegEx();if(!f.test(b)){var g=this.getValidRegEx(!0);b=b.replace(g,"")}}return b=this.trimToMax(b),b=this.addRequiredChar(b),b=this.trimToMax(b),this.isValid(b)?b:void 0},b.prototype.trimToMax=function(a){var b=a;return b.length>this.max&&(b=b.substr(0,this.max)),b},b.prototype.addRequiredChar=function(a){var b=a;if(0===this.required.length)return b;for(var c=!1,d=0;d<this.required.length;d++)if(b.indexOf(this.required[d])!==-1){c=!0;break}if(this.required.length>0&&!c){var e=this.required[0];b=e+b}return b},b}),function(a,b){"use strict";if("function"==typeof define&&define.amd)define(["saltthepass/domainnamerule","saltthepass/utils","crypto-js/md5","crypto-js/sha1","crypto-js/sha512","crypto-js/sha3","crypto-js/ripemd160","crypto-js/enc-base64"],b);else if("object"==typeof exports){var c="";try{require("crypto-js/md5")}catch(a){c="../node_modules/"}module.exports=b(require("./domainnamerule"),require("./utils"),require(c+"crypto-js/md5"),require(c+"crypto-js/sha1"),require(c+"crypto-js/sha512"),require(c+"crypto-js/sha3"),require(c+"crypto-js/ripemd160"),require(c+"crypto-js/enc-base64"))}else a.SaltThePass=b(a.DomainNameRule,a.SaltThePassUtils,a.CryptoJS.MD5,a.CryptoJS.SHA1,a.CryptoJS.SHA512,a.CryptoJS.SHA3,a.CryptoJS.RIPEMD160,a.CryptoJS.enc.Base64)}(this,function(a,b,c,d,e,f,g,h){"use strict";var i={};i.DomainNameRule=a,i.standardizeDomain=b.standardizeDomain;var j={md5:{length:22,fn:c},sha1:{length:27,fn:d},sha2:{length:86,fn:e},sha3:{length:86,fn:f},ripemd160:{length:27,fn:g}};return i.getHashes=function(){var a=[];for(var b in j)j.hasOwnProperty(b)&&a.push(b);return a},i.getHashFn=function(a){if(a in j)return j[a].fn},i.getHashLength=function(a){return a in j?j[a].length:0},i.hash=function(a,b){if("undefined"!=typeof b&&b.length){var c=this.getHashFn(a);if("undefined"!=typeof c){var d=c(b),e=d.toString(h);return e=e.replace(/\=+$/,""),e=e.replace(/\+/g,"-"),e=e.replace(/\//g,"_")}}},i.saltthepass=function(a,b,c,d){return"undefined"==typeof b&&(b=""),"undefined"==typeof c&&(c=""),"undefined"==typeof d&&(d=""),this.hash(a,b+c+d)},i});
//# sourceMappingURL=saltthepass.min.js.map